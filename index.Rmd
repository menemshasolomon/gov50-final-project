---
title: "Gov 50 Final Project"
author: "Mena Solomon"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---



## Project thoughts

Why do certain individuals believe in automatic voter registration and to what extent is an individual’s perspective on automatic registration affected by their political party? In this study I plan to analyze data on the relationship between political party, race, and belief about automatic voter registration, while simultaneously comparing these conclusions to the results found on polls regarding voter ID laws. I believe that comparing these policies will be interesting as automatic registration is a somewhat new concept in America, whereas voter ID laws are historically controversial and skew on party lines. I hypothesize that views about automatic voter registration will correlate strongly with political party, much like support for voter ID laws. Furthermore, I expect that racially marginalized groups (who are typically excluded by our current system of voter registration) will tend to favor both of these measures above white voters. To analyze this data I will first break down support for automatic registration (VTPRIORITY_a_W87 where 1 = Strongly favor and 4 = Strongly oppose) and then group that data based on the explanatory variables — political party affiliation (F_PARTY_FINAL 	1 = Republican, 2 = Democrat, 3= Independent, 4 = Something else)  and race (F_RACETHNMOD 1 = White, non-Hispanic,  2 = Black, non-Hispanic , 3 = Hispanic, 4 = Other, 5 = Asian, non-Hispanic, 99 = Refused). I will then apply the same methodology to to the data on the other response variable, voter id laws (VTPRIORITY_j_W87 where  1 = Strongly favor and 4 = Strongly oppose). By identifying the correlation between opinion on the legislation and both race and political party, I will be able to understand how opinions on automatic voter registration differ in the United States and the mechanisms by which people arrive at those conclusions. If views on automatic registration group based on race and party affiliation (like they do for voter ID laws), it will prove my hypothesis that marginalized groups often left out of the voting process support automatic registration as another mechanism by which voting access can be expanded. If the data indicates no correlation between the explanatory variables and opinion on automatic registration (or less of a correlation than is present for voter id laws), it will prove that automatic registration is viewed as intrinsically different than other policies which seek to expand voting access.

```{r}
library(tidyverse)
library(haven)
library(infer)
data <-  read_sav("data/ATP W87.sav")

data <- data |>
  select(QKEY, F_AGECAT, F_GENDER, F_RACETHNMOD, F_PARTY_FINAL, VTPRIORITY_a_W87, VTPRIORITY_j_W87)|>
  rename(automaticregistration = VTPRIORITY_a_W87,
         voteridlaws = VTPRIORITY_j_W87,
         party = F_PARTY_FINAL,
         race = F_RACETHNMOD) |>
  filter(party != 4,
         party != 3,
         party != 99, 
         voteridlaws != 99,
         automaticregistration != 99,
         race != 4,
         race != 99) |>
  mutate(
    partylabel = case_when(
      party == 1 ~ "Republican",
      party == 2 ~ "Democrat"),
    racelabel = case_when(
      race == 1 ~ "White, non-Hispanic",
      race == 2 ~ "Black, non-Hispanic",
      race == 3 ~ "Hispanic",
      race == 5 ~ "Asian, non-Hispanic"),
    voteridlabel = case_when(
      voteridlaws <= 2 ~ "Supports Voter ID Laws",
      voteridlaws > 2 ~ "Against Voter ID Laws"),
    automaticreglabel = case_when(
      automaticregistration <= 2 ~ "Supports Automatic Registration",
      automaticregistration > 2 ~ "Against Automatic Registration"))


```

```{r}
voterid_plot_party <- data |>
  group_by(party) |>
  ggplot(aes(x = factor(voteridlabel), fill = factor(partylabel))) +
  geom_bar(position = "dodge") +
  labs(x = "Opinion on Voter ID Laws", 
       y = "Number of Respondents", 
       title = "How Party Membership Affects Respondents Views on Voter ID Laws",
       fill = "Party")

voterid_plot_party

automatic_registration_plot_party <- data |>
  group_by(party) |>
  ggplot(aes(x = factor(automaticreglabel), fill = factor(partylabel))) +
  geom_bar(position = "dodge") +
  labs(x = "Opinion on Automatic Registration", 
       y = "Number of Respondents", 
       title = "How Party Membership Affects Respondents Views on Automatic Registration",
       fill = "Party")

automatic_registration_plot_party
```
```{r}
party_cor <- data |>
  summarize(cor(party, voteridlaws),
            cor(party, automaticregistration)) 
knitr::kable(party_cor,
             col.names = c("Correlation Between Party Membership and Views on Voter ID Laws",
                           "Correlation Between Party Membership and Views on Automatic Registration"),
             caption = "Mathematical Correlations of the Data Displayed Above")
```
From the Data Visualization as well as the numerical values displayed above, it becomes clear that the party membership of a respondent correlates with their views on both voter ID laws and automatic registration. Membership with the Democratic Party correlates with negative attitudes towards voter ID laws by a coefficient of 0.45. For automatic registration, however, membership with the Democratic Party correlates with more positive views of the policy, by a coefficient of -0.54.

```{r}
voterid_plot_race <- data |>
  group_by(race) |>
  ggplot(aes(x = factor(voteridlabel), fill = factor(racelabel))) +
  geom_bar(position = "dodge") +
  labs(x = "Opinion on Voter ID Laws", 
       y = "Number of Respondents", 
       title = "How Race Affects Respondents Views on Voter ID Laws",
       fill = "Race")

voterid_plot_race

automatic_registration_plot_race <- data |>
  group_by(race) |>
  ggplot(aes(x = factor(automaticreglabel), fill = factor(racelabel))) +
  geom_bar(position = "dodge") +
  labs(x = "Opinion on Automatic Registration", 
       y = "Number of Respondents", 
       title = "How Race Affects Respondents Views on Automatic Registration",
       fill = "Race")

automatic_registration_plot_race
```


```{r}
automaticreg_race_boots <- data |>
  rep_slice_sample(prop = 1, reps = 1000, replace = TRUE) |>
  group_by(replicate, racelabel) |>
  summarize(automaticregistrationmean = mean(automaticregistration)) |>
  pivot_wider(names_from = racelabel, values_from = automaticregistrationmean) |>
  mutate(ATE = `Black, non-Hispanic` - `White, non-Hispanic`)

ate_ci_95 <- automaticreg_race_boots |>
select(replicate, ATE) |>
get_confidence_interval(level = 0.95, type = "percentile")
ate_ci_95

automaticreg_race_boots |>
  ggplot(mapping = aes(x = ATE))+
  geom_histogram(aes(y = after_stat(density)), binwidth = 0.01) +
  geom_vline(xintercept = unlist(ate_ci_95), color = "red") +
  labs(x = "Average Treatment Effect", 
       y = "Density", 
       title = "1,000 Bootstrap Replications of the Estimated Average Treatment Effect",
       subtitle = "How Race Effects Views on Automatic Registration")

voteridlaws_race_boots <- data |>
  rep_slice_sample(prop = 1, reps = 1000, replace = TRUE) |>
  group_by(replicate, racelabel) |>
  summarize(voteridlawsmean = mean(voteridlaws)) |>
  pivot_wider(names_from = racelabel, values_from = voteridlawsmean) |>
  mutate(ATE = `Black, non-Hispanic` - `White, non-Hispanic`)

ate_ci_95 <- voteridlaws_race_boots |>
select(replicate, ATE) |>
get_confidence_interval(level = 0.95, type = "percentile")
ate_ci_95

voteridlaws_race_boots |>
  ggplot(mapping = aes(x = ATE))+
  geom_histogram(aes(y = after_stat(density)), binwidth = 0.01) +
  geom_vline(xintercept = unlist(ate_ci_95), color = "red") +
  labs(x = "Average Treatment Effect", 
       y = "Density", 
       title = "1,000 Bootstrap Replications of the Estimated Average Treatment Effect",
       subtitle = "How Race Effects Views on Voter ID Laws")
```
In this experiment a respondent's views on both voter ID laws and automatic registration are compared on the basis of racial group. The average treatment effect here displays the difference in views on both policies for those who identify as white and those who identify as black. In an attempt to limit the interference of outside variables, bootstrap replications were used here, generating 1000 random sample groups. The bootstrap replications display the number of samples which result in a particular average treatment effect. For the graph of views on automatic registration, the average treatment effect follows a normal distribution with the center located around -0.6, meaning on average black respondents were more in favor of automatic registration than white respondents by about 0.6 points. Similarly, the ATE for voter id laws also follows a normal distribution; however, the center is located around 0.3, thus on average black respondents were less in favor of voter id laws than white respondents by about 0.3 points.

For both of these bootstrap samples, the 95% confidence interval does not include zero. Thus, at least at the 95% confidence interval, it is possible to discount the idea that race bears no effect on a respondent's views on both automatic registration and voter id laws.

```{r}
library(infer)
library(modelsummary)
fit_ate_party <- lm(voteridlaws ~ race + party + F_GENDER + F_AGECAT, data = data)

modelsummary::modelsummary(fit_ate_party,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("nobs", "r.squared", "adj.r.squared"))  

fit_ate_party <- lm(automaticregistration ~ race + party + F_GENDER + F_AGECAT, data = data)

modelsummary::modelsummary(fit_ate_party,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("nobs", "r.squared", "adj.r.squared"))  
```


```{r}
voterid_diff <- data |>
  filter(race !=5,
         race != 3) |>
  group_by(racelabel) |>
  summarize(voteridlawsmean = mean(voteridlaws)) |>
  pivot_wider(names_from = racelabel, values_from = voteridlawsmean) |>
  mutate(ATE = `Black, non-Hispanic` - `White, non-Hispanic`)
voterid_diff 

automaticreg_diff <- data |>
  filter(race !=5,
         race != 3) |>
  group_by(racelabel) |>
  summarize(automaticregistrationmean = mean(automaticregistration)) |>
  pivot_wider(names_from = racelabel, values_from = automaticregistrationmean) |>
  mutate(ATE = `Black, non-Hispanic` - `White, non-Hispanic`)
automaticreg_diff

```